# Описание задачи

1 Мы получает элементы по APi https://dev.nmcms.ru/api/services/
2 выводим их делаем клиентски и серверный компонент
3 Добавляем кнопку избранное
4 Добавляем счетчик количества и кнопку добавления товара в корзину
5 Добавляем кнопу сравнения
6 создаем страницы сравнения и корзины
7 Все это нужно записать в redux и local storage
8 Запросы на сравнение, избранное и корзину уходят сюда https://dev.nmcms.ru/api/

# Добавление товаров в избранное

- Вот пример добавления
  comp list_server
  list fav
  action add
  item_id f0182322
  subitem_id
  quantity 1

# Так же есть пояснения от бэка

Теперь получение избранных, я могу это записать в локал или куки или же у тебя будет отдельный api для страницы избранное?

Владимир, [10.06.2025 14:11]
и что ты запишешь в куки

Владимир, [10.06.2025 14:11]
весь товар?

Владимир, [10.06.2025 14:12]
конечно апи

Владимир, [10.06.2025 14:12]
хотя кстати аспро записывает историю просмотра в локал сторедж)

Владимир, [10.06.2025 14:12]
целиком весь товар

Bakhadir, [10.06.2025 14:13]
Думал записать id товара

Владимир, [10.06.2025 14:16]
comp: 'list_server'
list: 'fav'

Владимир, [10.06.2025 14:16]
без action

Владимир, [10.06.2025 14:16]
по идее возвращает содержимое списка

Владимир, [10.06.2025 14:16]
указанного в list

Владимир, [10.06.2025 14:16]
у меня сейчас в избранном ничё нет

Владимир, [10.06.2025 14:16]
{
"items": [],
"total_cost": 0,
"total_quantity": 0
}

Владимир, [10.06.2025 14:16]
поэтому так

Владимир, [10.06.2025 14:18]
у тебя после добавления в items должны приходить записи о товарах

Владимир, [10.06.2025 14:18]
и тут соответственно суммы

Владимир, [10.06.2025 14:18]
"total_cost": 35082,
"total_quantity": 4

Владимир, [10.06.2025 14:20]
но вообще этот компонент сделан для вывода информационных блоков в шапке например

Владимир, [10.06.2025 14:21]

Владимир, [10.06.2025 14:21]
для полноценных страниц там отдельные компоненты созданы

Владимир, [10.06.2025 14:21]
но в случае с избранным он фактически ничем не отличается

Владимир, [10.06.2025 14:26]
чтобы отрисовать вот эту штуку например

Владимир, [10.06.2025 14:26]

Bakhadir, [10.06.2025 14:26]
Понял, как раз тестирую

Владимир, [10.06.2025 14:27]
можно и нужно использовать list_server

Владимир, [10.06.2025 14:27]
поэтому action=add и отдавал сразу её а не success

Владимир, [10.06.2025 14:28]
но в большинстве случаев список товаров не нужен, нужно кол-во

Владимир, [10.06.2025 14:28]
список нужен в fly_basket )

Владимир, [10.06.2025 14:29]
и по идее ты должен обновлять эти блоки сразу после операции со list_server

Владимир, [10.06.2025 14:29]
чё-то добавил или удалил, получил success, обновил суммы

Владимир, [10.06.2025 14:30]
типа сколько товаров в избранном

Владимир, [10.06.2025 14:31]
но вообще ты конечно можешь и сам просто увеличить этот счётчик на +1 ))

Владимир, [10.06.2025 14:31]
но тебе нужна эта цифра в главном шаблоне

Владимир, [10.06.2025 14:31]
ну то есть чел положил 5 элементов в избранное

Владимир, [10.06.2025 14:31]
затем обновил страницу

Владимир, [10.06.2025 14:31]
тебе нужно отобразить текущее кол-во элементов

Владимир, [10.06.2025 14:32]
или сумму товаров в корзине

Владимир, [10.06.2025 14:32]
так что по идее тебе нужно по делать запрос к бэкенду

Владимир, [10.06.2025 14:32]
брать оттуда total_quantity

Владимир, [10.06.2025 14:32]
или total_items

Владимир, [10.06.2025 14:32]
и лепить на фронт эту цифру

Владимир, [10.06.2025 14:34]
плюс еще при загрузке страницы нужно отмечать товары которые уже в избранном (да в любом списке)

Владимир, [10.06.2025 14:34]

Владимир, [10.06.2025 14:34]
там в блоке данных о товаре должен приходить подмассив exists_in_lists

Владимир, [10.06.2025 14:34]
если в нём есть элемент fav, значит товар уже добавлен в избранное и его нужно выделить

# План реализации

## 1. API и типы данных

- [x] Настроить базовый API клиент
- [x] Определить типы для ответов API
- [x] Реализовать методы для работы с избранным (add, remove, get)
- [ ] Реализовать методы для работы с корзиной
- [ ] Реализовать методы для работы со сравнением

## 2. Redux Store

- [x] Создать slice для избранного
- [x] Реализовать асинхронные действия (thunks)
- [x] Настроить обработку состояний загрузки и ошибок
- [ ] Создать slice для корзины
- [ ] Создать slice для сравнения
- [ ] Настроить селекторы для оптимизации

## 3. Компоненты UI

### Избранное

- [x] Компонент кнопки избранного (Client)
- [x] Обработка состояний (loading, error)
- [ ] Страница избранного (Server)
  - [ ] Получение данных на сервере
  - [ ] Клиентский компонент для интерактивности
- [ ] Информационный блок в шапке с количеством (Client)

### Корзина

- [ ] Компонент кнопки добавления в корзину (Client)
- [ ] Счетчик количества товаров (Client)
- [ ] Страница корзины (Server)
  - [ ] Получение данных на сервере
  - [ ] Клиентский компонент для интерактивности
- [ ] Информационный блок в шапке с суммой (Client)

### Сравнение

- [ ] Компонент кнопки сравнения (Client)
- [ ] Страница сравнения (Server)
  - [ ] Получение данных на сервере
  - [ ] Клиентский компонент для интерактивности
- [ ] Информационный блок в шапке с количеством (Client)

## 4. Интеграция с сервером

- [x] Настроить получение списка товаров
- [x] Реализовать добавление/удаление из избранного
- [ ] Реализовать работу с корзиной
- [ ] Реализовать работу со сравнением
- [ ] Обработка exists_in_lists для отметки товаров
- [ ] Настроить серверные компоненты для начальной загрузки данных

## 5. Оптимизация

- [ ] Кэширование данных
- [ ] Оптимизация ререндеров
- [ ] Обработка офлайн-режима
- [ ] Обработка ошибок сети
- [ ] Оптимизация гидратации

## 6. Тестирование

- [ ] Написать тесты для API
- [ ] Написать тесты для Redux
- [ ] Написать тесты для компонентов
- [ ] Проверить все сценарии использования
- [ ] Проверить серверный рендеринг

## 7. Документация

- [ ] Описать API методы
- [ ] Описать структуру данных
- [ ] Добавить комментарии к коду
- [ ] Создать README с инструкциями

## Текущий прогресс

- [x] Настроен API клиент
- [x] Реализована работа с избранным
- [x] Настроен Redux store для избранного
- [x] Реализован компонент кнопки избранного
- [ ] В процессе реализации информационных блоков

## Архитектура страниц

### Серверные компоненты (page.tsx)

- Получение начальных данных
- Рендеринг статического контента
- Передача данных клиентским компонентам

### Клиентские компоненты

- Интерактивные элементы (кнопки, формы)
- Управление состоянием
- Обработка событий
- Информационные блоки в шапке
